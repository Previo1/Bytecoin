<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BYTE COIN â€” Auto Mining (With Tasks)</title>
<link rel="icon" href="coin.png" />
<style>
Â  :root{
Â  Â  --bg:#0b1220; --card:#0f1724; --accent:#f59e0b; --muted:#94a3b8; --glass: rgba(255,255,255,0.03);
Â  Â  --glass-2: rgba(255,255,255,0.02);
Â  }
Â  *{box-sizing:border-box}
Â  body{ margin:0; font-family:Inter, system-ui, Arial; background:linear-gradient(180deg,#061021,#07162a); color:#e6eef8; -webkit-font-smoothing:antialiased;}
Â  header.appbar{
Â  Â  display:flex; align-items:center; gap:12px; padding:14px 18px; background:linear-gradient(90deg, rgba(255,255,255,0.02), transparent);
Â  Â  border-bottom:1px solid rgba(255,255,255,0.02);
Â  Â  position:relative;
Â  }
Â  .logo{ width:48px; height:48px; border-radius:12px; background:var(--glass); display:flex; align-items:center; justify-content:center; overflow:hidden }
Â  .logo img{ width:36px; height:36px; }
Â  .big-title {
Â  Â  position:absolute; left:50%; transform:translateX(-50%); top:8px;
Â  Â  font-weight:900; letter-spacing:6px; text-transform:uppercase;
Â  Â  background:linear-gradient(90deg,#ffd26b 0%, #f59e0b 45%, #ffcc80 100%);
Â  Â  -webkit-background-clip:text; background-clip:text; color:transparent;
Â  Â  text-shadow:0 2px 0 rgba(0,0,0,0.2), 0 6px 22px rgba(255,193,7,0.25);
Â  Â  font-size:22px;
Â  }
Â  .header-meta{ margin-left:auto; text-align:right; font-size:13px; color:var(--muted); }
Â  .header-meta .pts{ color:var(--accent); font-weight:800; font-size:15px; }

Â  main{ padding:18px; max-width:920px; margin:18px auto 120px; }
Â  .card{ background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; padding:16px; margin-bottom:14px; border:1px solid rgba(255,255,255,0.03); box-shadow: 0 8px 30px rgba(2,6,23,0.6);}
Â  .big-coin{ width:160px; height:160px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: transform .12s ease; border:6px solid rgba(255,255,255,0.04); box-shadow: 0 18px 40px rgba(5,10,20,0.6);}
Â  .big-coin:active{ transform:scale(0.95) rotate(-6deg); }
Â  .big-coin img{ width:100px; height:100px; user-select:none; -webkit-user-drag:none; }
Â  .mine-row{ display:flex; gap:18px; align-items:center; flex-wrap:wrap; }
Â  .status h2{ margin:4px 0 6px; font-size:18px; }
Â  .muted{ color:var(--muted); font-size:13px; }
Â  .progress-bar{ width:100%; height:12px; background:rgba(255,255,255,0.03); border-radius:999px; overflow:hidden; margin-top:10px; }
Â  .progress-fill{ height:100%; width:0%; background:linear-gradient(90deg,var(--accent),#ffd26b); transition:width .3s ease; }
Â  .controls{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
Â  .btn{ padding:8px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:700; background:rgba(255,255,255,0.03); color:#fff; }
Â  .btn.primary{ background:linear-gradient(90deg,var(--accent),#ffb84d); color:#07121b; }
Â  .btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.03); color:var(--muted); }

Â  footer.appfooter{ position:fixed; left:0; right:0; bottom:0; display:flex; justify-content:space-around; background:linear-gradient(180deg, rgba(2,6,23,0.7), rgba(2,6,23,0.85)); padding:10px 6px; border-top:1px solid rgba(255,255,255,0.02); backdrop-filter: blur(6px);}
Â  .nav-btn{ background:none; border:none; color:var(--muted); font-weight:700; cursor:pointer; display:flex; flex-direction:column; align-items:center; gap:4px; min-width:72px }
Â  .nav-btn svg{ width:22px; height:22px; opacity:.9 }
Â  .nav-btn.active{ color:var(--accent); }
Â  .nav-btn.active svg{ filter: drop-shadow(0 0 6px rgba(245,158,11,.35)); }

Â  input.small{ width:100%; padding:10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.03); color:#e6eef8; }
Â  .share-row{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
Â  .share-btn{ padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:700; }
Â  .tg{ background:#0088cc; color:#fff; }
Â  .wa{ background:#25D366; color:#07121b; }
Â  .join-btn{ padding:10px 14px; border-radius:10px; background:#1976d2; color:#fff; border:0; font-weight:800; cursor:pointer; }
Â  .small-note{ font-size:13px; color:var(--muted); margin-top:8px; }
Â  .history-item{ padding:8px 0; border-bottom:1px dashed rgba(255,255,255,0.03); font-size:13px; }
Â  .center{ text-align:center; }

Â  .task { background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); border-radius:12px; padding:12px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; gap:12px; }
Â  .task .meta { text-align:left; }
Â  .task.done { opacity:0.5; }

Â  .withdraw-row{ display:flex; gap:8px; align-items:center; margin-top:10px; }
Â  .withdraw-row input{ flex:1; }

Â  .pulse { animation: pulseAnim 0.6s ease; }
Â  @keyframes pulseAnim {
Â  Â  0% { transform: scale(1); color: var(--accent); }
Â  Â  50% { transform: scale(1.2); color: #ffd26b; }
Â  Â  100% { transform: scale(1); color: var(--accent); }
Â  }

Â  @media (max-width:520px){
Â  Â  .big-coin{ width:130px; height:130px } .big-coin img{ width:80px;height:80px }
Â  Â  .big-title{font-size:18px; top:6px; letter-spacing:4px}
Â  Â  .header-meta{font-size:12px}
Â  Â  .withdraw-row{flex-direction:column;align-items:stretch}
Â  }
</style>
</head>
<body>

<header class="appbar">
Â  <div class="logo"><img src="coin.png" alt="bytecoin" /></div>
Â  <div class="big-title">BYTE COIN</div>
Â  <div class="header-meta">
Â  Â  <div>Points: <span id="headerPoints" class="pts">0</span> pts</div>
Â  Â  <div>Coins: <span id="headerCoins">0</span> â‚¿</div>
Â  </div>
</header>

<main>
Â  <!-- HOME -->
Â  <section id="page-home" class="card">
Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
Â  Â  Â  <div>
Â  Â  Â  Â  <div class="muted">Total Supply</div>
Â  Â  Â  Â  <div style="font-weight:800;font-size:18px">22,000,000 â‚¿</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="text-align:right">
Â  Â  Â  Â  <div class="muted">Referral reward (both)</div>
Â  Â  Â  Â  <div style="font-weight:800;font-size:18px">+100 â‚¿ each</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="mine-row" style="margin-top:14px;">
Â  Â  Â  <div class="big-coin center" id="bigCoinBtn" title="Tap to get +1 point">
Â  Â  Â  Â  <img src="coin.png" alt="coin">
Â  Â  Â  </div>

Â  Â  Â  <div style="flex:1; min-width:220px;">
Â  Â  Â  Â  <div class="status">
Â  Â  Â  Â  Â  <h2>Auto Mining: <span id="mineState">Stopped</span></h2>
Â  Â  Â  Â  Â  <div class="muted">Speed: <b id="mineSpeed">1 min/point</b> â€¢ Next point in <span id="nextTick">--:--</span></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div style="margin-top:10px;">
Â  Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;font-size:13px;">
Â  Â  Â  Â  Â  Â  <div class="muted">Points: <b id="pointsDisplay">0</b> / 100</div>
Â  Â  Â  Â  Â  Â  <div class="muted">Coins: <b id="coinsDisplay">0</b></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  <button class="btn primary" id="toggleMine">Start Auto-Mining</button>
Â  Â  Â  Â  Â  <button class="btn ghost" id="instantTap">Instant +1</button>
Â  Â  Â  Â  Â  <button class="btn" id="settingsBtn">Options</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="small-note">Tip: For continuous mining keep the tab/app open in foreground.</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <!-- REFERRAL -->
Â  <section id="page-referral" class="card" style="display:none">
Â  Â  <h3>Referral & Channel</h3>
Â  Â  <div style="display:flex;gap:12px;flex-wrap:wrap;">
Â  Â  Â  <div style="flex:1;min-width:240px">
Â  Â  Â  Â  <div style="font-weight:700">Your referal link ğŸ–‡ï¸</div>
Â  Â  Â  Â  <input id="refInput" class="small" readonly style="margin-top:8px"/>
Â  Â  Â  Â  <div class="share-row">
Â  Â  Â  Â  Â  <button class="share-btn tg" id="shareTG">Share to Telegram</button>
Â  Â  Â  Â  Â  <button class="share-btn wa" id="shareWA">Share to WhatsApp</button>
Â  Â  Â  Â  Â  <button class="btn" id="copyRef">Copy</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="small-note">When a new user opens your referral link they receive +100 â‚¿ immediately and an claim-code is generated. Send the code to you so you can claim +100 â‚¿ (one-tap claim supported).</div>
Â  Â  Â  </div>

Â  Â  Â  <div style="flex:1;min-width:240px">
Â  Â  Â  Â  <div style="font-weight:700">Join Channel</div>
Â  Â  Â  Â  <div class="small-note">Click join and you'll receive <b>+500 â‚¿</b>. (Join must be confirmed server-side for 100% trust â€” here credited on click.)</div>
Â  Â  Â  Â  <div style="margin-top:10px;">
Â  Â  Â  Â  Â  <a id="channelLink" class="join-btn" href="https://t.me/bytecoinS22m" target="_blank">Join Channel</a>
Â  Â  Â  Â  Â  <div style="margin-top:8px"><button class="btn" id="claimChannelBtn">Claim Channel Bonus</button></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div style="margin-top:16px;">
Â  Â  Â  Â  Â  <div style="font-weight:700">Redeem Claim Code</div>
Â  Â  Â  Â  Â  <input id="redeemCodeInput" class="small" placeholder="Paste claim code here" style="margin-top:8px"/>
Â  Â  Â  Â  Â  <div style="margin-top:8px"><button class="btn primary" id="redeemBtn">Redeem +100 â‚¿</button></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <!-- WALLET -->
Â  <section id="page-wallet" class="card" style="display:none">
Â  Â  <h3>Wallet</h3>
Â  Â  <div style="display:flex;gap:12px;flex-wrap:wrap;">
Â  Â  Â  <div style="flex:1;min-width:180px;">
Â  Â  Â  Â  <div class="muted">Total Coins</div>
Â  Â  Â  Â  <div style="font-weight:800;font-size:20px" id="walletCoins">0</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="flex:1;min-width:180px;">
Â  Â  Â  Â  <div class="muted">Total Points</div>
Â  Â  Â  Â  <div style="font-weight:800;font-size:20px" id="walletPoints">0</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="card" style="margin-top:14px;">
Â  Â  Â  <h4>Withdraw Coins</h4>
Â  Â  Â  <div class="muted">àª…àª¹à«€àª‚àª¥à«€ àª¤àª®àª¾àª°àª¾ ByteCoin (àª¸à«àª¥àª¾àª¨à«€àª¯ àª¡à«‡àª®à«‹) withdraw àª•àª°à«‹</div>
Â  Â  Â  <div class="withdraw-row" style="margin-top:10px;">
Â  Â  Â  Â  <input id="withdrawAmount" class="small" type="number" min="1" placeholder="Amount (â‚¿)" />
Â  Â  Â  Â  <input id="withdrawTo" class="small" type="text" placeholder="Recipient User ID" />
Â  Â  Â  </div>
Â  Â  Â  <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
Â  Â  Â  Â  <button class="btn primary" id="withdrawBtn">Withdraw</button>
Â  Â  Â  Â  <button class="btn" id="withdrawDemoBtn">Demo Withdraw (show)</button>
Â  Â  Â  </div>
Â  Â  Â  <div class="small-note">Note: This is a local/demo withdraw â€” real transfers need a backend & blockchain.</div>
Â  Â  </div>

Â  Â  <h4 style="margin-top:12px">History</h4>
Â  Â  <div id="historyBox" style="max-height:260px; overflow:auto; margin-top:6px"></div>
Â  </section>

Â  <!-- TASKS (NEW) -->
Â  <section id="page-tasks" class="card" style="display:none">
Â  Â  <h3>Mini Tasks ğŸ¯</h3>
Â  Â  <div class="small-note">Complete these simple tasks to earn extra ByteCoin. Claimed tasks cannot be claimed again (stored locally).</div>

Â  Â  <div id="taskList" style="margin-top:12px;">
Â  Â  Â  <div class="task" id="task-join">
Â  Â  Â  Â  <div class="meta">
Â  Â  Â  Â  Â  <div style="font-weight:700">Join Extra Channel</div>
Â  Â  Â  Â  Â  <div class="muted">Open channel link and then press Claim to get <b>+200 â‚¿</b> (demo click-based).</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <a href="https://t.me/bytecoinS22m" target="_blank" class="btn" style="display:block;margin-bottom:8px">Open Channel</a>
Â  Â  Â  Â  Â  <button class="btn primary" onclick="claimTask('task-join',200)">Claim +200 â‚¿</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div class="task" id="task-share">
Â  Â  Â  Â  <div class="meta">
Â  Â  Â  Â  Â  <div style="font-weight:700">Share Referral Link with 3 Friends</div>
Â  Â  Â  Â  Â  <div class="muted">Share your referral link using the share buttons and then press Claim to get <b>+300 â‚¿</b>. (Demo â€” we trust your click.)</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <div style="display:flex; gap:8px; margin-bottom:8px;">
Â  Â  Â  Â  Â  Â  <button class="share-btn tg" id="taskShareTG">TG</button>
Â  Â  Â  Â  Â  Â  <button class="share-btn wa" id="taskShareWA">WA</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <button class="btn primary" onclick="claimTask('task-share',300)">Claim +300 â‚¿</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div class="task" id="task-daily">
Â  Â  Â  Â  <div class="meta">
Â  Â  Â  Â  Â  <div style="font-weight:700">Daily Check-in</div>
Â  Â  Â  Â  Â  <div class="muted">Claim once per day for <b>+50 â‚¿</b>. Streaks can be added later.</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <button class="btn primary" onclick="claimDailyCheckin()">Claim +50 â‚¿</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <!-- PROFILE -->
Â  <section id="page-profile" class="card" style="display:none">
Â  Â  <h3>Profile</h3>
Â  Â  <div style="display:flex;gap:12px;flex-wrap:wrap;">
Â  Â  Â  <div style="flex:1;min-width:180px;">
Â  Â  Â  Â  <div class="muted">Telegram ID</div>
Â  Â  Â  Â  <div id="profileTelegram" style="font-weight:800">â€”</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="flex:1;min-width:180px;">
Â  Â  Â  Â  <div class="muted">User ID</div>
Â  Â  Â  Â  <div id="profileUser" style="font-weight:800">â€”</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div style="margin-top:12px" class="muted">
Â  Â  Â  <div style="font-weight:700">Mining details</div>
Â  Â  Â  <ul style="margin-top:8px">
Â  Â  Â  Â  <li>1 minute = 1 point (Auto-Mining when ON)</li>
Â  Â  Â  Â  <li>100 points = 1 ByteCoin (auto-convert)</li>
Â  Â  Â  Â  <li>Referral: referee +100 instantly; referrer redeems via claim code or one-tap claim link</li>
Â  Â  Â  Â  <li>Channel join click â†’ +500 ByteCoin (click-based credit)</li>
Â  Â  Â  </ul>
Â  Â  </div>
Â  </section>

</main>

<!-- BOTTOM NAV â€” icon + name only (added Tasks button) -->
<footer class="appfooter">
Â  <button id="menuHome" class="nav-btn active" title="Home">
Â  Â  <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 3 2 12h3v8h6v-5h2v5h6v-8h3L12 3z"/></svg>
Â  Â  <span>Home</span>
Â  </button>
Â  <button id="menuReferral" class="nav-btn" title="Referral">
Â  Â  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 11c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 3-1.34 3-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.67 0-8 1.34-8 4v2h10v-2c0-2.66-5.33-4-8-4zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.95 1.97 3.45v2H24v-2c0-2.66-5.33-4-8-4z"/></svg>
Â  Â  <span>Referral</span>
Â  </button>
Â  <button id="menuWallet" class="nav-btn" title="Wallet">
Â  Â  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 7H3V5h14l4 2zM3 19h18a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2zm13-7h4v4h-4v-4z"/></svg>
Â  Â  <span>Wallet</span>
Â  </button>
Â  <button id="menuTasks" class="nav-btn" title="Tasks">
Â  Â  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
Â  Â  <span>Tasks</span>
Â  </button>
Â  <button id="menuProfile" class="nav-btn" title="Profile">
Â  Â  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4 0-10 2-10 6v2h20v-2c0-4-6-6-10-6z"/></svg>
Â  Â  <span>Profile</span>
Â  </button>
</footer>

<script>
/* ------------------------
Â  Keys & init
-------------------------*/
const KEY = {
Â  uid: 'bc_userId',
Â  tg: 'bc_tgId',
Â  pts: 'bc_points',
Â  cns: 'bc_coins',
Â  hist: 'bc_history',
Â  refUsed: 'bc_refUsed',
Â  outgoingClaim: 'bc_outClaim',
Â  claimedCodes: 'bc_claimedCodes',
Â  channelBonus: 'bc_channelBonus',
Â  minerOn: 'bc_minerOn',
Â  tasks: 'bc_tasks',            // object of task claims
Â  dailyLast: 'bc_dailyLast'    // last daily check-in date
};

function now(){ return new Date().toLocaleString(); }
function todayStr(){ const d=new Date(); return `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`; }
function randCode(){ return 'BC' + Math.random().toString(36).slice(2,9).toUpperCase(); }

/* --- Pulse Animation Helper --- */
function pulse(el){
Â  if(!el) return;
Â  el.classList.add('pulse');
Â  setTimeout(()=> el.classList.remove('pulse'), 600);
}

/* user */
let userId = localStorage.getItem(KEY.uid);
if(!userId){ userId = 'user_' + Math.floor(Math.random()*900000+100000); localStorage.setItem(KEY.uid, userId); }
document.getElementById('profileUser').innerText = userId;

/* optional telegram id from query */
const params = new URLSearchParams(window.location.search);
const tgParam = params.get('tg_id') || params.get('tgid') || params.get('telegram_id') || null;
if(tgParam) localStorage.setItem(KEY.tg, tgParam);
const tgId = localStorage.getItem(KEY.tg) || 'â€”';
document.getElementById('profileTelegram').innerText = tgId;

/* points/coins/history */
let points = parseInt(localStorage.getItem(KEY.pts) || '0',10);
let coins = parseInt(localStorage.getItem(KEY.cns) || '0',10);
let history = JSON.parse(localStorage.getItem(KEY.hist) || '[]');
let claimedCodes = JSON.parse(localStorage.getItem(KEY.claimedCodes) || '[]');
let tasksState = JSON.parse(localStorage.getItem(KEY.tasks) || '{}');

/* ui refs */
const headerPoints = document.getElementById('headerPoints');
const headerCoins = document.getElementById('headerCoins');
const pointsDisplay = document.getElementById('pointsDisplay');
const coinsDisplay = document.getElementById('coinsDisplay');
const walletPoints = document.getElementById('walletPoints');
const walletCoins = document.getElementById('walletCoins');
const progressFill = document.getElementById('progressFill');
const historyBox = document.getElementById('historyBox');
const refInput = document.getElementById('refInput');

/* mining vars */
const POINTS_PER_COIN = 100;
const MS_PER_POINT = 60_000; // 1 min
let minerInterval = null;
let lastTickAt = Date.now();

/* render */
function renderAll(){
Â  headerPoints.innerText = points;
Â  headerCoins.innerText = coins;
Â  pointsDisplay && (pointsDisplay.innerText = points);
Â  coinsDisplay && (coinsDisplay.innerText = coins);
Â  walletPoints.innerText = points;
Â  walletCoins.innerText = coins;
Â  const percent = Math.min(100, Math.floor((points/POINTS_PER_COIN)*100));
Â  progressFill && (progressFill.style.width = percent + '%');
Â  // history
Â  historyBox.innerHTML = history.slice().reverse().map(h => `<div class="history-item"><div>${h.msg}</div><div class="muted">${h.time}</div></div>`).join('');
Â  // referral input
Â  refInput && (refInput.value = window.location.origin + window.location.pathname + '?ref=' + userId);
Â  // tasks UI
Â  renderTasksUI();
}

/* save/load */
function saveAll(){
Â  localStorage.setItem(KEY.pts, String(points));
Â  localStorage.setItem(KEY.cns, String(coins));
Â  localStorage.setItem(KEY.hist, JSON.stringify(history));
Â  localStorage.setItem(KEY.claimedCodes, JSON.stringify(claimedCodes));
Â  localStorage.setItem(KEY.tasks, JSON.stringify(tasksState));
}
function addHistory(msg){
Â  history.push({msg, time: now()});
Â  if(history.length>300) history.shift();
Â  saveAll(); renderAll();
}

/* --- addPoint with animation --- */
function addPoint(n=1, reason=''){
Â  points += n;
Â  addHistory(`${reason} (+${n} pts)`);
Â  // convert
Â  if(points >= POINTS_PER_COIN){
Â  Â  const g = Math.floor(points / POINTS_PER_COIN);
Â  Â  coins += g;
Â  Â  points = points % POINTS_PER_COIN;
Â  Â  addHistory(`Converted ${g*POINTS_PER_COIN} pts â†’ ${g} â‚¿`);
Â  Â  pulse(headerCoins); // coins pulse
Â  }
Â  saveAll(); renderAll();
Â  pulse(headerPoints); // points pulse
}

/* instant tap and big coin */
document.getElementById('instantTap').addEventListener('click', ()=> addPoint(1, 'Instant tap'));
document.getElementById('bigCoinBtn').addEventListener('click', ()=> addPoint(1, 'Tap'));

/* miner start/stop */
const toggleBtn = document.getElementById('toggleMine');
const mineStateEl = document.getElementById('mineState');
const nextTickEl = document.getElementById('nextTick');
document.getElementById('mineSpeed').innerText = '1 min/point';

function startMiner(){
Â  if(minerInterval) return;
Â  minerInterval = setInterval(()=> { addPoint(1, 'Auto-mined'); lastTickAt = Date.now(); }, MS_PER_POINT);
Â  lastTickAt = Date.now();
Â  toggleBtn.innerText = 'Stop Auto-Mining';
Â  mineStateEl.innerText = 'Running';
Â  localStorage.setItem(KEY.minerOn, '1');
Â  addHistory('Auto-miner started');
}
function stopMiner(){
Â  if(!minerInterval) return;
Â  clearInterval(minerInterval);
Â  minerInterval = null;
Â  toggleBtn.innerText = 'Start Auto-Mining';
Â  mineStateEl.innerText = 'Stopped';
Â  localStorage.setItem(KEY.minerOn, '0');
Â  addHistory('Auto-miner stopped');
}
toggleBtn.addEventListener('click', ()=> { if(minerInterval) stopMiner(); else startMiner(); });

/* tick UI */
setInterval(()=>{
Â  if(minerInterval){
Â  Â  const elapsed = Date.now() - lastTickAt;
Â  Â  const left = Math.max(0, MS_PER_POINT - elapsed);
Â  Â  const mm = Math.floor(left/60000); const ss = Math.floor((left%60000)/1000);
Â  Â  nextTickEl.innerText = `${String(mm).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;
Â  } else nextTickEl.innerText = '--:--';
}, 500);

/* Referral flow (serverless-friendly) */
(function handleIncomingReferralOrClaim(){
Â  const params = new URLSearchParams(window.location.search);
Â  const ref = params.get('ref');
Â  const claim = params.get('claim');

Â  if(ref && ref !== userId && !localStorage.getItem(KEY.refUsed)){
Â  Â  // Give referee +100 coins immediately (big viral incentive)
Â  Â  coins += 100;
Â  Â  addHistory(`Referral bonus: +100 â‚¿ (as referee of ${ref})`);
Â  Â  // create outgoing claim code for referrer
Â  Â  const code = randCode();
Â  Â  const out = { code, from: userId, to: ref, at: new Date().toISOString() };
Â  Â  localStorage.setItem(KEY.outgoingClaim, JSON.stringify(out));
Â  Â  localStorage.setItem(KEY.refUsed, JSON.stringify({from:ref, at: new Date().toISOString()}));
Â  Â  saveAll(); renderAll();
Â  Â  // show claim info visually
Â  Â  alert(`Referral applied! You received +100 â‚¿.\nSend this Claim Code to your referrer so they can claim theirs:\n\n${code}`);
Â  Â  // append claim box to referral page (if user stays)
Â  Â  setTimeout(()=> renderOutgoingClaim(), 300);
Â  }

Â  // If someone opens with ?claim=CODE we auto-redeem for them
Â  if(claim){
Â  Â  tryRedeemCode(claim);
Â  }
})();

/* render outgoing claim box */
function renderOutgoingClaim(){
Â  const raw = localStorage.getItem(KEY.outgoingClaim);
Â  if(!raw) return;
Â  const o = JSON.parse(raw);
Â  if(!document.getElementById('outClaimBox')){
Â  Â  const box = document.createElement('div');
Â  Â  box.id = 'outClaimBox';
Â  Â  box.style.marginTop = '12px';
Â  Â  box.innerHTML = `<div style="font-weight:700">Your Claim Code</div>
Â  Â  Â  <div class="muted">Send this code to the person who referred you on Telegram</div>
Â  Â  Â  <div style="display:flex;gap:8px;margin-top:8px">
Â  Â  Â  Â  <input id="outClaimInput" class="small" value="${o.code}" readonly/>
Â  Â  Â  Â  <button class="btn" id="copyOutClaim">Copy</button>
Â  Â  Â  </div>`;
Â  Â  document.getElementById('page-referral').appendChild(box);
Â  Â  document.getElementById('copyOutClaim').addEventListener('click', ()=> {
Â  Â  Â  navigator.clipboard.writeText(o.code).then(()=> alert('Claim code copied'));
Â  Â  });
Â  }
}

/* Redeem code for referrer */
function tryRedeemCode(code){
Â  if(!code) { alert('Enter a valid claim code'); return; }
Â  code = String(code).trim().toUpperCase();
Â  // prevent reuse
Â  if(claimedCodes.includes(code)){ alert('This code is already redeemed'); return; }
Â  // Validate: serverless â€” we cannot verify remote; we accept and credit.
Â  coins += 100;
Â  claimedCodes.push(code);
Â  addHistory(`Redeemed claim code ${code} â†’ +100 â‚¿`);
Â  saveAll(); renderAll();
Â  alert('+100 â‚¿ credited to your account.');
}

/* redeem button */
document.getElementById('redeemBtn').addEventListener('click', ()=>{
Â  const c = document.getElementById('redeemCodeInput').value;
Â  tryRedeemCode(c);
});

/* copy referral */
document.getElementById('copyRef').addEventListener('click', ()=>{
Â  navigator.clipboard.writeText(refInput.value).then(()=> alert('Referral link copied'));
});

/* share tg / wa */
document.getElementById('shareTG').addEventListener('click', ()=>{
Â  const text = `Join me on ByteCoin Auto Mining! Use my referral: ${refInput.value} â€” get +100 â‚¿ instantly.`;
Â  const url = `https://t.me/share/url?url=${encodeURIComponent(refInput.value)}&text=${encodeURIComponent(text)}`;
Â  window.open(url, '_blank');
});
document.getElementById('shareWA').addEventListener('click', ()=>{
Â  const text = `Join me on ByteCoin Auto Mining! Use my referral: ${refInput.value} â€” get +100 â‚¿ instantly.`;
Â  const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
Â  window.open(url, '_blank');
});

/* Channel join claim (click-based) */
document.getElementById('claimChannelBtn').addEventListener('click', ()=>{
Â  if(localStorage.getItem(KEY.channelBonus) === '1'){ alert('Channel bonus already claimed'); return; }
Â  // click-based credit
Â  coins += 500;
Â  localStorage.setItem(KEY.channelBonus, '1');
Â  addHistory('+500 ByteCoin (Channel Join Bonus)');
Â  saveAll(); renderAll();
Â  alert('Channel bonus credited: +500 â‚¿');
});

/* ------------------------
Â  Â WITHDRAW (local/demo)
-------------------------*/
document.getElementById('withdrawBtn').addEventListener('click', ()=>{
Â  const amtEl = document.getElementById('withdrawAmount');
Â  const toEl = document.getElementById('withdrawTo');
Â  const rawAmt = amtEl.value.trim();
Â  const toId = toEl.value.trim() || 'unknown';
Â  if(!rawAmt || isNaN(rawAmt) || Number(rawAmt) <= 0){ alert('Enter a valid amount'); return; }
Â  const amt = Math.floor(Number(rawAmt));
Â  if(amt > coins){ alert('Insufficient coins'); return; }
Â  // subtract and record
Â  coins -= amt;
Â  addHistory(`Withdrew ${amt} â‚¿ to ${toId}`);
Â  saveAll(); renderAll();
Â  alert(`Withdrawn ${amt} â‚¿ to ${toId} (demo).`);
Â  amtEl.value = '';
Â  toEl.value = '';
});

/* demo withdraw button to show sample (no change) */
document.getElementById('withdrawDemoBtn').addEventListener('click', ()=>{
Â  alert('Demo withdraw just shows the form â€” use Withdraw to perform a local demo transfer.');
});

/* wallet render on load */
function init(){
Â  renderAll();
Â  renderOutgoingClaim();
Â  if(localStorage.getItem(KEY.minerOn) === '1') startMiner();
Â  catchUpMining();
Â  showPage('page-home');
}
window.addEventListener('load', init);

/* simple navigation */
function showPage(id){
Â  ['page-home','page-referral','page-wallet','page-tasks','page-profile'].forEach(p=>{
Â  Â  const el = document.getElementById(p);
Â  Â  if(el) el.style.display = (p === id) ? 'block' : 'none';
Â  });
Â  document.querySelectorAll('footer.appfooter .nav-btn').forEach(b=>b.classList.remove('active'));
Â  if(id === 'page-home') document.getElementById('menuHome').classList.add('active');
Â  if(id === 'page-referral') document.getElementById('menuReferral').classList.add('active');
Â  if(id === 'page-wallet') document.getElementById('menuWallet').classList.add('active');
Â  if(id === 'page-tasks') document.getElementById('menuTasks').classList.add('active');
Â  if(id === 'page-profile') document.getElementById('menuProfile').classList.add('active');
}
document.getElementById('menuHome').addEventListener('click', ()=> showPage('page-home'));
document.getElementById('menuReferral').addEventListener('click', ()=> showPage('page-referral'));
document.getElementById('menuWallet').addEventListener('click', ()=> showPage('page-wallet'));
document.getElementById('menuTasks').addEventListener('click', ()=> showPage('page-tasks'));
document.getElementById('menuProfile').addEventListener('click', ()=> showPage('page-profile'));

/* save on unload + last tick timestamp for offline catch-up */
function catchUpMining(){
Â  const last = parseInt(localStorage.getItem('bc_lastTick') || '0', 10);
Â  if(last > 0 && localStorage.getItem(KEY.minerOn) === '1'){
Â  Â  const elapsed = Date.now() - last;
Â  Â  const gained = Math.floor(elapsed / MS_PER_POINT);
Â  Â  if(gained > 0){
Â  Â  Â  addPoint(gained, `Offline catch-up (${gained} pts)`);
Â  Â  Â  lastTickAt = Date.now();
Â  Â  }
Â  }
}
window.addEventListener('beforeunload', ()=> {
Â  localStorage.setItem('bc_lastTick', String(Date.now()));
Â  localStorage.setItem(KEY.minerOn, minerInterval ? '1' : '0');
});

/* expose for debug */
window.BYTE = { addPoint, startMiner, stopMiner, tryRedeemCode, state: ()=>({points,coins}) };

/* ------------------------
Â  Â TASKS: logic + UI
-------------------------*/
function renderTasksUI(){
Â  // task-join, task-share, task-daily
Â  const tJoin = tasksState['task-join'];
Â  const tShare = tasksState['task-share'];
Â  const tDaily = tasksState['task-daily'];

Â  const elJoin = document.getElementById('task-join');
Â  const elShare = document.getElementById('task-share');
Â  const elDaily = document.getElementById('task-daily');

Â  if(tJoin) elJoin.classList.add('done'); else elJoin.classList.remove('done');
Â  if(tShare) elShare.classList.add('done'); else elShare.classList.remove('done');

Â  // daily: check if already claimed today
Â  const lastDaily = localStorage.getItem(KEY.dailyLast);
Â  if(lastDaily === todayStr()){ elDaily.classList.add('done'); } else elDaily.classList.remove('done');

Â  // disable buttons if done
Â  Array.from(document.querySelectorAll('#taskList .task')).forEach(task=>{
Â  Â  const btn = task.querySelector('button.btn.primary');
Â  Â  if(!btn) return;
Â  Â  if(task.classList.contains('done')) btn.disabled = true; else btn.disabled = false;
Â  });
}

/* Claim generic task (demo-trust model) */
function claimTask(id, reward){
Â  if(!tasksState[id]){
Â  Â  // mark claimed
Â  Â  tasksState[id] = {claimedAt: new Date().toISOString(), reward};
Â  Â  coins += reward;
Â  Â  addHistory(`Task ${id} claimed â†’ +${reward} â‚¿`);
Â  Â  saveAll(); renderAll();
Â  Â  alert(`Task completed! +${reward} â‚¿ credited.`);
Â  } else {
Â  Â  alert('àª† àªŸàª¾àª¸à«àª• àªªàª¹à«‡àª²à«‡àª¥à«€ àªœ àª•à«àª²à«‡àªˆàª® àª¥àªˆ àªšà«àª•à«€ àª›à«‡.');
Â  }
}

/* Task share buttons (for UX) */
document.getElementById('taskShareTG').addEventListener('click', ()=>{
Â  const link = window.location.origin + window.location.pathname + '?ref=' + userId;
Â  const text = `Join ByteCoin Auto Mining! Use my referral: ${link} â€” get +100 â‚¿ instantly.`;
Â  window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
});
document.getElementById('taskShareWA').addEventListener('click', ()=>{
Â  const link = window.location.origin + window.location.pathname + '?ref=' + userId;
Â  const text = `Join ByteCoin Auto Mining! Use my referral: ${link} â€” get +100 â‚¿ instantly.`;
Â  window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
});

/* Daily check-in claim */
function claimDailyCheckin(){
Â  const last = localStorage.getItem(KEY.dailyLast);
Â  const today = todayStr();
Â  if(last === today){
Â  Â  alert('àª†àªœà«‡ àª¤àª®à«‡ àªªàª¹à«‡àª²à«‡àª¥à«€ àªœ àªšà«‡àª•-àª‡àª¨àª¨à«€ àª•à«àª²à«‡àª‡àª® àª•àª°à«€ àª›à«‡.');
Â  Â  return;
Â  }
Â  // award
Â  const reward = 50;
Â  coins += reward;
Â  localStorage.setItem(KEY.dailyLast, today);
Â  addHistory(`Daily check-in â†’ +${reward} â‚¿`);
Â  saveAll(); renderAll();
Â  alert(`Daily check-in claimed! +${reward} â‚¿`);
}

/* Restore tasks UI from localStorage on load */
(function restoreTasksOnLoad(){
Â  const raw = localStorage.getItem(KEY.tasks);
Â  if(raw) {
Â  Â  try { tasksState = JSON.parse(raw); } catch(e){ tasksState = {}; }
Â  } else tasksState = {};
Â  // ensure UI reflects state after a small delay (after DOM ready)
Â  setTimeout(()=> renderTasksUI(), 250);
})();
</script>
</body>
</html>

